#include <stdio.h>

#include "aes.h"

int main(){
    //unsigned char key[16]    = {0x40,0x68,0xF2,0x01,0xBD,0xFA,0x64,0x79,0x31,0x56,0x6E,0x3C,0x80,0xDB,0xC9,0xB3};
    unsigned char plain[16]  = {0xBA,0xA6,0xB8,0xB2,0x27,0xCF,0x32,0xA5,0x64,0x13,0xB3,0x7A,0x1D,0x7F,0xE5,0xC2};
    unsigned char golden[16] = {0x73,0x2d,0x73,0xd1,0x43,0xe3,0x7b,0x2e,0x1e,0xbb,0x60,0xc0,0xcf,0x82,0x85,0x01};
    unsigned char roundkey[176] = 
{
    0x51,0x6A,0xD6,0x1D,0x94,0x7A,0x55,0xD0,0x2D,0xD6,0x0B,0x92,0x7B,0x71,0xED,0x14,
    0xF3,0x3F,0x2C,0x3C,0x67,0x45,0x79,0xEC,0x4A,0x93,0x72,0x7E,0x31,0xE2,0x9F,0x6A,
    0x69,0xE4,0x2E,0xFB,0x0E,0xA1,0x57,0x17,0x44,0x32,0x25,0x69,0x75,0xD0,0xBA,0x03,
    0x1D,0x10,0x55,0x66,0x13,0xB1,0x02,0x71,0x57,0x83,0x27,0x18,0x22,0x53,0x9D,0x1B,
    0xF8,0x4E,0xFA,0xF5,0xEB,0xFF,0xF8,0x84,0xBC,0x7C,0xDF,0x9C,0x9E,0x2F,0x42,0x87,
    0xFD,0x62,0xED,0xFE,0x16,0x9D,0x15,0x7A,0xAA,0xE1,0xCA,0xE6,0x34,0xCE,0x88,0x61,
    0x56,0xA6,0x02,0xE6,0x40,0x3B,0x17,0x9C,0xEA,0xDA,0xDD,0x7A,0xDE,0x14,0x55,0x1B,
    0xEC,0x5A,0xAD,0xFB,0xAC,0x61,0xBA,0x67,0x46,0xBB,0x67,0x1D,0x98,0xAF,0x32,0x06,
    0x15,0x79,0xC2,0xBD,0xB9,0x18,0x78,0xDA,0xFF,0xA3,0x1F,0xC7,0x67,0x0C,0x2D,0xC1,
    0xF0,0xA1,0xBA,0x38,0x49,0xB9,0xC2,0xE2,0xB6,0x1A,0xDD,0x25,0xD1,0x16,0xF0,0xE4,
    0x81,0x2D,0xD3,0x06,0xC8,0x94,0x11,0xE4,0x7E,0x8E,0xCC,0xC1,0xAF,0x98,0x3C,0x25
};
    unsigned char cipher[16];
    Cipher( roundkey ,plain, cipher);
    fprintf(stdout, "----------Start!------------\n");
    int i;
    for(i=0;i<16;i++){
        if(cipher[i] != golden[i]){
            fprintf(stdout, "----------Fail!------------\n");
		    //return 1;
        }
    }

	fprintf(stdout, "----------Pass!------------\n");
    return 0;
}
