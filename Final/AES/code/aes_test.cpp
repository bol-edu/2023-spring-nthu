#include <stdio.h>

#include "aes.h"

int main(){
    unsigned char key[16]    = {0x40,0x68,0xF2,0x01,0xBD,0xFA,0x64,0x79,0x31,0x56,0x6E,0x3C,0x80,0xDB,0xC9,0xB3};
    unsigned char plain[16]  = {0xC7,0x45,0x0C,0xA5,0xFB,0xC6,0x72,0xF4,0xCD,0x59,0xDE,0x87,0xD1,0x53,0x1C,0x87};
    unsigned char golden[16] = {0x06,0x1b,0xa3,0x36,0x42,0x1f,0xe9,0x19,0xaf,0x2b,0x59,0x42,0xe8,0x8f,0x6d,0x9c};
    unsigned char roundkey[16];
    unsigned char cipher[16];
    top_test(key,roundkey,plain,cipher,1);
    top_test(key,roundkey,plain,cipher,0);
    fprintf(stdout, "----------Start!------------\n");
    int i;
    for(i=0;i<16;i++){
        if(plain[i] != cipher[i]){
            fprintf(stderr, "----------Fail!------------\n");
		    return 1;
        }
    }

	fprintf(stdout, "----------Pass!------------\n");
    return 0;
}
